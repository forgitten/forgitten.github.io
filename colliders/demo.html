<!DOCTYPE html>
<html>
<head>
	<script src = "source/utilities.js"></script>
	<script src = "source/vec2.js"></script>
	<script src = "source/physics.js"></script>
</head>
<body>
	<canvas id ="main" width = "500" height = "500"></canvas>
	<script>
		var canvas = document.getElementById('main');
		var context = canvas.getContext('2d');
		
		
		
		var spheres = [
			new Sphere({pos:{x:180, y:220}, radius:20, speed:{x:0.6, y:-0.05}, mass : 4}),
			new Sphere({pos:{x:220, y:220}, radius:5, speed:{x:-0.2, y:0.05}, mass: 1}),
			new Sphere({pos:{x:200, y:270}, radius:30, speed:{x:-0.2, y:-0.8}}),
			new Sphere({pos:{x:190, y:400}, radius:80, speed:{x:-0.2, y:-5}, mass:5}),
		];
		
		
		function addRSpheres(n = 1){
			function r(x, y){return x + Math.round(Math.random() * (y - x))};
		
			spheres.push(new Sphere({ pos:{x:r(50, 500), y:r(50, 500)}, radius: r(5, 40), speed:{x:r(-5, 5)/5, y:r(-5, 5)/5}, mass:r(1, 30) }));
			
			
			if(n > 1){
				addRSpheres(--n);
			}
		}
		
		addRSpheres(10);
		
		function main(){
			requestAnimationFrame(main);
			
			spheres.forEach(function(s){
				if(s.speed) {
				s.pos.x += s.speed.x; s.pos.y += s.speed.y;
				};
			});
			
			
			for(var i = 0; i < spheres.length; i++){
				for(var j = i + 1; j < spheres.length; j++){
					Sphere.tempHandleSphere(spheres[i], spheres[j]);
				};
			};
			
			
			context.save()
			context.fillStyle = "red";
			context.fillRect(0,0, canvas.width, canvas.height);
			context.restore();
			
			
			spheres.forEach(function(s){
				context.beginPath();
				context.fillStyle = "pink";
				context.arc(s.pos.x, s.pos.y, s.radius, 0, 2 * Math.PI);
				context.fill(); 
			});
			
		};
		main();
	</script>

</body>
</html>
